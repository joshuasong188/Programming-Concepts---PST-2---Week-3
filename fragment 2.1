import json
import datetime
from typing import Any, Dict, List, Optional

DATA_FILE = "msms.json"

# Global data store for the entire app
app_data: Dict[str, Any] = {}

# --- Core Persistence Engine ---
def load_data(path: str = DATA_FILE) -> None:
    """Loads all application data from a JSON file into the global app_data."""
    global app_data
    try:
        with open(path, 'r') as f:
            app_data = json.load(f)
            print("Data loaded successfully.")
    except FileNotFoundError:
        print("Data file not found. Initializing with default structure.")
        app_data = {
            "students": [],
            "teachers": [],
            "attendance": [],
            "next_student_id": 1,
            "next_teacher_id": 1
        }

def save_data(path: str = DATA_FILE) -> None:
    """Saves all application data to a JSON file."""
    with open(path, 'w') as f:
        json.dump(app_data, f, indent=4)
    print("Data saved successfully.")
